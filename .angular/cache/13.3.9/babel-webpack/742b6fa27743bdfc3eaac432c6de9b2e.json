{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"./component/image-cropper.component\";\n\nfunction ImageComponent_div_21_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 1)(1, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function ImageComponent_div_21_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return ctx_r2.toggleContainWithinAspectRatio();\n    });\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function ImageComponent_div_21_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return ctx_r4.toggleAspectRatio();\n    });\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function ImageComponent_div_21_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return ctx_r5.moveLeft();\n    });\n    i0.ɵɵtext(6, \"move left\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function ImageComponent_div_21_Template_button_click_7_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return ctx_r6.moveRight();\n    });\n    i0.ɵɵtext(8, \"move right\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function ImageComponent_div_21_Template_button_click_9_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return ctx_r7.moveTop();\n    });\n    i0.ɵɵtext(10, \"move top\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function ImageComponent_div_21_Template_button_click_11_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return ctx_r8.moveBottom();\n    });\n    i0.ɵɵtext(12, \"move bottom\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function ImageComponent_div_21_Template_button_click_13_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return ctx_r9.allowMoveImage = !ctx_r9.allowMoveImage;\n    });\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r0.containWithinAspectRatio ? \"Fill Aspect Ratio\" : \"Contain Within Aspect Ratio\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Aspect ratio: \", ctx_r0.aspectRatio === 4 / 3 ? \"4/3\" : \"16/5\", \"\");\n    i0.ɵɵadvance(10);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r0.allowMoveImage ? \"Disable\" : \"Enable\", \" image panning \");\n  }\n}\n\nfunction ImageComponent_div_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 11);\n    i0.ɵɵtext(1, \"Loading... \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nexport let ImageComponent = /*#__PURE__*/(() => {\n  class ImageComponent {\n    constructor() {\n      this.imageChangedEvent = '';\n      this.croppedImage = '';\n      this.canvasRotation = 0;\n      this.translateH = 0;\n      this.translateV = 0;\n      this.scale = 1;\n      this.aspectRatio = 4 / 3;\n      this.showCropper = false;\n      this.containWithinAspectRatio = false;\n      this.transform = {\n        translateUnit: 'px'\n      };\n      this.loading = false;\n      this.allowMoveImage = true;\n    }\n\n    fileChangeEvent(event) {\n      this.loading = true;\n      this.imageChangedEvent = event;\n    }\n\n    imageCropped(event) {\n      this.croppedImage = event.base64;\n      console.log(event);\n    }\n\n    imageLoaded() {\n      this.showCropper = true;\n      console.log('Image loaded');\n    }\n\n    cropperReady(sourceImageDimensions) {\n      console.log('Cropper ready', sourceImageDimensions);\n      this.loading = false;\n    }\n\n    loadImageFailed() {\n      console.error('Load image failed');\n    }\n\n    rotateLeft() {\n      this.loading = true;\n      setTimeout(() => {\n        this.canvasRotation--;\n        this.flipAfterRotate();\n      });\n    }\n\n    rotateRight() {\n      this.loading = true;\n      setTimeout(() => {\n        this.canvasRotation++;\n        this.flipAfterRotate();\n      });\n    }\n\n    moveLeft() {\n      this.transform = Object.assign(Object.assign({}, this.transform), {\n        translateH: ++this.translateH\n      });\n    }\n\n    moveRight() {\n      this.transform = Object.assign(Object.assign({}, this.transform), {\n        translateH: --this.translateH\n      });\n    }\n\n    moveTop() {\n      this.transform = Object.assign(Object.assign({}, this.transform), {\n        translateV: ++this.translateV\n      });\n    }\n\n    moveBottom() {\n      this.transform = Object.assign(Object.assign({}, this.transform), {\n        translateV: --this.translateV\n      });\n    }\n\n    flipHorizontal() {\n      this.transform = Object.assign(Object.assign({}, this.transform), {\n        flipH: !this.transform.flipH\n      });\n    }\n\n    flipVertical() {\n      this.transform = Object.assign(Object.assign({}, this.transform), {\n        flipV: !this.transform.flipV\n      });\n    }\n\n    resetImage() {\n      this.scale = 1;\n      this.rotation = 0;\n      this.canvasRotation = 0;\n      this.transform = {\n        translateUnit: 'px'\n      };\n    }\n\n    zoomOut() {\n      this.scale -= .1;\n      this.transform = Object.assign(Object.assign({}, this.transform), {\n        scale: this.scale\n      });\n    }\n\n    zoomIn() {\n      this.scale += .1;\n      this.transform = Object.assign(Object.assign({}, this.transform), {\n        scale: this.scale\n      });\n    }\n\n    toggleContainWithinAspectRatio() {\n      this.containWithinAspectRatio = !this.containWithinAspectRatio;\n    }\n\n    updateRotation() {\n      this.transform = Object.assign(Object.assign({}, this.transform), {\n        rotate: this.rotation\n      });\n    }\n\n    toggleAspectRatio() {\n      this.aspectRatio = this.aspectRatio === 4 / 3 ? 16 / 5 : 4 / 3;\n    }\n\n    flipAfterRotate() {\n      const flippedH = this.transform.flipH;\n      const flippedV = this.transform.flipV;\n      this.transform = Object.assign(Object.assign({}, this.transform), {\n        flipH: flippedV,\n        flipV: flippedH\n      });\n      this.translateH = 0;\n      this.translateV = 0;\n    }\n\n  }\n\n  ImageComponent.ɵfac = function ImageComponent_Factory(t) {\n    return new (t || ImageComponent)();\n  };\n\n  ImageComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ImageComponent,\n    selectors: [[\"app-image\"]],\n    decls: 26,\n    vars: 22,\n    consts: [[1, \"image-wrapper\"], [1, \"toolbar\"], [\"type\", \"file\", 3, \"change\"], [\"placeholder\", \"URL to load image\", \"type\", \"text\", 3, \"ngModel\", \"ngModelChange\"], [3, \"click\"], [\"placeholder\", \"Rotation\", \"type\", \"number\", 3, \"ngModel\", \"ngModelChange\"], [\"class\", \"toolbar\", 4, \"ngIf\"], [1, \"cropper-wrapper\"], [\"backgroundColor\", \"#ffff\", \"format\", \"png\", 3, \"transform\", \"alignImage\", \"allowMoveImage\", \"aspectRatio\", \"canvasRotation\", \"containWithinAspectRatio\", \"cropperMinWidth\", \"imageChangedEvent\", \"imageURL\", \"maintainAspectRatio\", \"onlyScaleDown\", \"resizeToWidth\", \"roundCropper\", \"cropperReady\", \"imageCropped\", \"imageLoaded\", \"loadImageFailed\", \"transformChange\"], [\"class\", \"loader\", 4, \"ngIf\"], [3, \"src\"], [1, \"loader\"]],\n    template: function ImageComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"input\", 2);\n        i0.ɵɵlistener(\"change\", function ImageComponent_Template_input_change_2_listener($event) {\n          return ctx.fileChangeEvent($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"input\", 3);\n        i0.ɵɵlistener(\"ngModelChange\", function ImageComponent_Template_input_ngModelChange_3_listener($event) {\n          return ctx.imageURL = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(4, \"div\", 1)(5, \"button\", 4);\n        i0.ɵɵlistener(\"click\", function ImageComponent_Template_button_click_5_listener() {\n          return ctx.resetImage();\n        });\n        i0.ɵɵtext(6, \"Reset image\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(7, \" | \");\n        i0.ɵɵelementStart(8, \"button\", 4);\n        i0.ɵɵlistener(\"click\", function ImageComponent_Template_button_click_8_listener() {\n          return ctx.rotateLeft();\n        });\n        i0.ɵɵtext(9, \"Rotate left\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"button\", 4);\n        i0.ɵɵlistener(\"click\", function ImageComponent_Template_button_click_10_listener() {\n          return ctx.rotateRight();\n        });\n        i0.ɵɵtext(11, \"Rotate right\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"button\", 4);\n        i0.ɵɵlistener(\"click\", function ImageComponent_Template_button_click_12_listener() {\n          return ctx.flipHorizontal();\n        });\n        i0.ɵɵtext(13, \"Flip horizontal\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"button\", 4);\n        i0.ɵɵlistener(\"click\", function ImageComponent_Template_button_click_14_listener() {\n          return ctx.flipVertical();\n        });\n        i0.ɵɵtext(15, \"Flip vertical\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"input\", 5);\n        i0.ɵɵlistener(\"ngModelChange\", function ImageComponent_Template_input_ngModelChange_16_listener() {\n          return ctx.updateRotation();\n        })(\"ngModelChange\", function ImageComponent_Template_input_ngModelChange_16_listener($event) {\n          return ctx.rotation = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(17, \"button\", 4);\n        i0.ɵɵlistener(\"click\", function ImageComponent_Template_button_click_17_listener() {\n          return ctx.zoomOut();\n        });\n        i0.ɵɵtext(18, \"Zoom -\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"button\", 4);\n        i0.ɵɵlistener(\"click\", function ImageComponent_Template_button_click_19_listener() {\n          return ctx.zoomIn();\n        });\n        i0.ɵɵtext(20, \"Zoom +\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(21, ImageComponent_div_21_Template, 15, 3, \"div\", 6);\n        i0.ɵɵelementStart(22, \"div\", 7)(23, \"image-cropper\", 8);\n        i0.ɵɵlistener(\"cropperReady\", function ImageComponent_Template_image_cropper_cropperReady_23_listener($event) {\n          return ctx.cropperReady($event);\n        })(\"imageCropped\", function ImageComponent_Template_image_cropper_imageCropped_23_listener($event) {\n          return ctx.imageCropped($event);\n        })(\"imageLoaded\", function ImageComponent_Template_image_cropper_imageLoaded_23_listener() {\n          return ctx.imageLoaded();\n        })(\"loadImageFailed\", function ImageComponent_Template_image_cropper_loadImageFailed_23_listener() {\n          return ctx.loadImageFailed();\n        })(\"transformChange\", function ImageComponent_Template_image_cropper_transformChange_23_listener($event) {\n          return ctx.transform = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(24, ImageComponent_div_24_Template, 2, 0, \"div\", 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(25, \"img\", 10);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.imageURL);\n        i0.ɵɵadvance(13);\n        i0.ɵɵproperty(\"ngModel\", ctx.rotation);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", !ctx.allowMoveImage);\n        i0.ɵɵadvance(2);\n        i0.ɵɵstyleProp(\"display\", ctx.showCropper ? null : \"none\");\n        i0.ɵɵproperty(\"transform\", ctx.transform)(\"alignImage\", \"center\")(\"allowMoveImage\", ctx.allowMoveImage)(\"aspectRatio\", ctx.aspectRatio)(\"canvasRotation\", ctx.canvasRotation)(\"containWithinAspectRatio\", ctx.containWithinAspectRatio)(\"cropperMinWidth\", 128)(\"imageChangedEvent\", ctx.imageChangedEvent)(\"imageURL\", ctx.imageURL)(\"maintainAspectRatio\", true)(\"onlyScaleDown\", true)(\"resizeToWidth\", 128)(\"roundCropper\", false);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.loading);\n        i0.ɵɵadvance(1);\n        i0.ɵɵstyleProp(\"border\", ctx.croppedImage ? \"1px solid black\" : \"none\");\n        i0.ɵɵproperty(\"src\", ctx.croppedImage, i0.ɵɵsanitizeUrl);\n      }\n    },\n    directives: [i1.DefaultValueAccessor, i1.NgControlStatus, i1.NgModel, i1.NumberValueAccessor, i2.NgIf, i3.ImageCropperComponent],\n    styles: [\".image-wrapper[_ngcontent-%COMP%]{width:100%;border:1px solid #ccc;padding:5px}.image-wrapper[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]{border:1px solid red;padding:5px}.image-wrapper[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px;position:relative;flex-shrink:0;fill:currentColor}\"]\n  });\n  return ImageComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}